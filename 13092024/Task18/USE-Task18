Скопируем ячейку A1 таблицы в другое место, к примеру в ячейку A17.
В каждой ячейке первого столбца и первой строки значение заряда, которое может иметь робот, находясь там, не зависит от
его предыдущего пути (т.к. робот может двигаться только вправо или вниз).
В таком случае заполним ячейки B1-O17 следующей формулой: =IF(B1>A1,A17+B1,A17-B1)
То есть, если значение в ячейке B1 больше, чем в A1, то в ячейку B17 мы поместим значение A17+B1, в противном случае
мы поместим в неё значение A17-B1. В соответствии с условием задачи.
Аналогично заполним ячейки А18-А31 такой формулой: =IF(A2>A1,A17+A2,A17-A2)

Далее, значение заряда робота всегда будет зависеть от его предыдущего пути. Нам нужно рассмотреть две крайности для
каждой ячейки - максимальное значение, и минимальное. Сначала рассмотрим случай с максимальным желаемым зарядом
Поместим в ячейки B18-O31 следующую формулу:
=MAX(IF(B2>A2,A18+B2,A18-B2),IF(B2>B1,B17+B2,B17-B2))
Мы сравниваем значение, которое получилось бы если бы робот пришёл из ячейки сверху, или из ячейки слева.
В таком случае в ячейке О31 будет лежать ответ на задачу: 3081. В случае с минимальным зарядом,
заменяем формулу на =MIN(IF(B2>A2,A18+B2,A18-B2),IF(B2>B1,B17+B2,B17-B2)). Тогда в О31 будет находиться значение 1656

Ответ: 3081 | 1656